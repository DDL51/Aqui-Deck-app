    elif modo == "Orçamento":
        st.subheader("Orçamento para Cliente")
        nome_cliente = st.text_input("Nome do Cliente")
        contato = st.text_input("Contato")
        bairro = st.text_input("Bairro")

        if "itens" not in st.session_state:
            st.session_state.itens = []
        nomes_produtos = [p["nome"] for p in dados["Produtos"]]
        produto_sel = st.selectbox("Produto:", nomes_produtos)
        qtd = st.number_input("Quantidade", min_value=0.0)
        comp = st.number_input("Comprimento (em mm)", min_value=0.0)

        if st.button("Adicionar Produto"):
            valor_unit = next((p["valor_final"] for p in dados["Produtos"] if p["nome"] == produto_sel), 0)
            total = (qtd * comp / 1000) * valor_unit
            st.session_state.itens.append({"produto": produto_sel, "qtd": qtd, "comp": comp, "valor_unit": valor_unit, "total": total})
            st.success(f"{produto_sel} adicionado ao pedido!")

        if st.session_state.itens:
            st.subheader("Itens do Pedido")
            total_geral = sum(i["total"] for i in st.session_state.itens)
            for i, item in enumerate(st.session_state.itens):
                st.write(f"{i+1}. {item['produto']} - Qtd: {item['qtd']} - Comp: {item['comp']} mm - Total: R$ {item['total']:.2f}")
            st.write(f"**Total Geral: R$ {total_geral:.2f}**")

        if st.button("Salvar Orçamento e Enviar"):
            if nome_cliente.strip() and contato.strip():
                arquivo = gerar_pdf(nome_cliente, contato, bairro, st.session_state.itens, total_geral)
                sucesso = enviar_para_drive(arquivo)

                if sucesso:
                    orcamentos = carregar_orcamentos()
                    novo_orcamento = {
                        "nome_cliente": nome_cliente,
                        "contato": contato,
                        "bairro": bairro,
                        "itens": st.session_state.itens,
                        "total": total_geral,
                        "data": datetime.now().strftime("%Y-%m-%d %H:%M:%S")
                    }
                    orcamentos.append(novo_orcamento)
                    salvar_orcamentos(orcamentos)
                    st.success("Orçamento salvo e PDF enviado para o Google Drive!")
                    st.session_state.itens = []
            else:
                st.warning("Preencha nome do cliente e contato.")